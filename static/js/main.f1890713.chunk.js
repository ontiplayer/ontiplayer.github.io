(this["webpackJsonpcorona-games"]=this["webpackJsonpcorona-games"]||[]).push([[0],{28:function(e,t,a){},39:function(e,t,a){},40:function(e,t,a){},41:function(e,t,a){},46:function(e,t,a){},47:function(e,t,a){},49:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a(1),i=a.n(n),r=a(29),o=a.n(r),c=(a(39),a(8)),l=a(18),d=a(2),h=a(3),u=a(6),m=a(5),p=(a(40),a(13)),f=a(4),j=a(16);function g(e,t){var a=window.localStorage.getItem(e);return void 0===a||null===a?(window.localStorage.setItem(e,t),t):a}function b(e,t){window.localStorage.setItem(e,t)}function v(e){return e&&"object"===typeof e&&!Array.isArray(e)}function O(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),s=1;s<t;s++)a[s-1]=arguments[s];if(!a.length)return e;var n=a.shift();if(v(e)&&v(n))for(var i in n)v(n[i])?(e[i]||Object.assign(e,Object(j.a)({},i,{})),O(e[i],n[i])):Object.assign(e,Object(j.a)({},i,n[i]));return O.apply(void 0,[e].concat(a))}function y(e){var t,a,s;for(s=e.length-1;s>0;s--)t=Math.floor(Math.random()*(s+1)),a=e[s],e[s]=e[t],e[t]=a;return e}var x=a(30);function k(){return C}var C=new(function(){function e(){Object(d.a)(this,e);var t=g("name","Name"),a=g("color","#00ff00"),s=g("id",([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})));this.player={name:t,color:a,id:s},this.groupId=-1,this.callbacks=[],this.msgQueue=[],this.state={}}return Object(h.a)(e,[{key:"addCallback",value:function(e){this.callbacks.push(e),e(this.state)}},{key:"setPlayerName",value:function(e){e&&e!==this.player.name&&(this.player.name=e,b("name",e),this.sendPlayerUpdate())}},{key:"setPlayerColor",value:function(e){e&&e!==this.player.color&&(this.player.color=e,b("color",e),this.sendPlayerUpdate())}},{key:"initialize",value:function(e,t){this.sessionId=e,this.ws=new WebSocket("wss://6h5xdbf9vc.execute-api.eu-central-1.amazonaws.com/production");var a=this;this.ws.onopen=function(){a.sendPlayerUpdate(),a.sendMessage({gameConfig:{name:t.name}}),console.log("send test message")},this.ws.onerror=function(e){console.log("WebSocket Error "+e)},this.ws.onmessage=function(e){console.log("Server: "+e.data);var t=JSON.parse(e.data);a.state=O(a.state,t),a.callbacks.forEach((function(e){return e(a.state)}))}}},{key:"sendPlayerUpdate",value:function(){var e={players:{}};e.players[this.player.id]=this.player,this.sendMessage(e)}},{key:"sendMessage",value:function(e){var t=this;this.msgQueue.push(e),this.sendTimeout&&clearTimeout(this.sendTimout);var a=this;this.sendTimeout=setTimeout((function(){var s={sessionId:t.sessionId};if(a.sendTimeout&&clearTimeout(a.sendTimout),!(a.msgQueue.length<1)){var n,i=Object(x.a)(a.msgQueue);try{for(i.s();!(n=i.n()).done;){O(s,n.value)}}catch(o){i.e(o)}finally{i.f()}a.msgQueue=[];var r=JSON.stringify(s);t.ws&&1===t.ws.readyState?(console.log("send message",r),t.ws.send(r)):t.msgQueue.push(e)}}),10)}}]),e}()),N=a(31),w=a.n(N),S=a(12),M=(a(41),function e(){Object(d.a)(this,e),this.name="Base Game",this.minPlayers=1,this.maxPlayers=100}),A=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(d.a)(this,a),(e=t.call(this)).name="TicTacToe",e.minPlayers=2,e.maxPlayers=2,e}return Object(h.a)(a,[{key:"getComponent",value:function(e){return Object(n.createElement)(R,e)}},{key:"start",value:function(e){var t=Math.round(Math.random()),a=Object.keys(e.players)[t],s=Object.keys(e.players)[(t+1)%2];k().sendMessage({gameConfig:{running:!0},game:{field:[0,0,0,0,0,0,0,0,0],playerA:a,playerB:s}})}}]),a}(M),R=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var s;return Object(d.a)(this,a),(s=t.call(this,e)).state={},s.checkField=s.checkField.bind(Object(c.a)(s)),s}return Object(h.a)(a,[{key:"mapIntToSymbol",value:function(e){switch(e){case 0:return"-";case 1:return"X";case 2:return"O"}}},{key:"checkField",value:function(e){var t=JSON.parse(JSON.stringify(this.props.state.game.field));0!==t[e]||this.state.gameover||(this.props.state.game.playerA===k().player.id&&this.props.state.game.field.filter((function(e){return 1===e})).length<=this.props.state.game.field.filter((function(e){return 2===e})).length&&(t[e]=1,k().sendMessage({game:{field:t}})),this.props.state.game.playerB===k().player.id&&this.props.state.game.field.filter((function(e){return 1===e})).length>this.props.state.game.field.filter((function(e){return 2===e})).length&&(t[e]=2,k().sendMessage({game:{field:t}})))}},{key:"render",value:function(){for(var e=this,t=this.props.state.game.field,a=[],n="",i="",r=!1,o=0,c=0,l=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];c<l.length;c++){var d=l[c];if(0!==t[d[0]]&&t[d[0]]===t[d[1]]&&t[d[1]]===t[d[2]]&&(r=!0,o=t[d[0]],this.state.gameover||this.setState({gameover:!0}),a=[].concat(Object(S.a)(a),Object(S.a)(d))),1===o)n=this.props.state.players[this.props.state.game.playerA].name+" has won the game!";if(2===o)n=this.props.state.players[this.props.state.game.playerB].name+" has won the game!"}if(0===a.length){if(this.props.state.game.field.filter((function(e){return 1===e})).length<=this.props.state.game.field.filter((function(e){return 2===e})).length)n=this.props.state.players[this.props.state.game.playerA].name+"'s turn";else n=this.props.state.players[this.props.state.game.playerB].name+"'s turn";void 0===t.find((function(e){return 0===e}))&&(r=!0,this.state.gameover||this.setState({gameover:!0}),n="Game finished with a tie!")}var h=this.props.state.game.field.map((function(t,n){return Object(s.jsx)("div",{onClick:function(){return e.checkField(n)},className:"card "+(a.includes(n)?" winningField ":""),style:{fontSize:"10vmin",textAlign:"center"},children:Object(s.jsx)("div",{className:"card-content",children:e.mapIntToSymbol(t)})})}));return this.state.gameover&&(r||setTimeout((function(){e.setState({gameover:!1})}),1),i=Object(s.jsxs)("div",{className:"panel-block",children:[Object(s.jsx)("button",{className:"button is-fullwidth ",onClick:function(){return k().sendMessage({gameConfig:{running:!1},game:void 0})},children:"Back to lobby"}),Object(s.jsx)("button",{className:"button is-fullwidth is-primary",onClick:function(){return setTimeout((function(){(new A).start(e.props.state)}),1)},children:"Restart game"})]})),Object(s.jsxs)("div",{className:"container is-half-desktop",children:[this.state.redirect?Object(s.jsx)(f.a,{to:this.state.redirect}):"",Object(s.jsx)("div",{className:"column is-6 is-offset-3",children:Object(s.jsxs)("nav",{className:"panel",children:[Object(s.jsx)("p",{className:"panel-heading",children:"TicTacToe"}),Object(s.jsx)("p",{className:"panel-block",children:n}),Object(s.jsx)("p",{className:"panel-block board",children:h}),i]})})]})}}]),a}(n.Component),I=(a(46),function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(d.a)(this,a),(e=t.call(this)).name="Vier gewinnt!",e.minPlayers=2,e.maxPlayers=2,e}return Object(h.a)(a,[{key:"getComponent",value:function(e){return Object(n.createElement)(T,e)}},{key:"start",value:function(e){var t=Math.round(Math.random()),a=Object.keys(e.players)[t],s=Object.keys(e.players)[(t+1)%2];k().sendMessage({gameConfig:{running:!0},game:{field:[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]],playerA:a,playerB:s}})}}]),a}(M)),T=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var s;return Object(d.a)(this,a),(s=t.call(this,e)).state={},s.boardRef=Object(n.createRef)(),s.checkField=s.checkField.bind(Object(c.a)(s)),window.onresize=function(){s.updateBoardSizing()},s}return Object(h.a)(a,[{key:"checkField",value:function(e){for(var t=JSON.parse(JSON.stringify(this.props.state.game.field)),a=-1,s=5;s>=0;s--)if(0===t[s][e]){a=s;break}a<0||this.gameover||(this.props.state.game.playerA===k().player.id&&t.flat().filter((function(e){return 1===e})).length<=t.flat().filter((function(e){return 2===e})).length&&(t[a][e]=1,k().sendMessage({game:{field:t}})),this.props.state.game.playerB===k().player.id&&t.flat().filter((function(e){return 1===e})).length>t.flat().filter((function(e){return 2===e})).length&&(t[a][e]=2,k().sendMessage({game:{field:t}})))}},{key:"render",value:function(){var e=this,t=this.props.state.game.field,a=[],n="",i="";this.gameover=!1;var r=0;t.forEach((function(e,t){for(var s=0;s<=3;s++)e[s]===e[s+1]&&e[s+1]===e[s+2]&&e[s+2]===e[s+3]&&0!==e[s]&&(a.push([s,t]),a.push([s+1,t]),a.push([s+2,t]),a.push([s+3,t]),r=e[s])}));for(var o=0;o<=6;o++)for(var c=0;c<=2;c++)t[c][o]===t[c+1][o]&&t[c+1][o]===t[c+2][o]&&t[c+2][o]===t[c+3][o]&&0!==t[c][o]&&(a.push([o,c]),a.push([o,c+1]),a.push([o,c+2]),a.push([o,c+3]),r=t[c][o]);for(var l=0;l<=3;l++)for(var d=0;d<=2;d++)t[d][l]===t[d+1][l+1]&&t[d+1][l+1]===t[d+2][l+2]&&t[d+2][l+2]===t[d+3][l+3]&&0!==t[d][l]&&(a.push([l,d]),a.push([l+1,d+1]),a.push([l+2,d+2]),a.push([l+3,d+3]),r=t[d][l]);for(var h=0;h<=3;h++)for(var u=0;u<=2;u++)t[u][h+3]===t[u+1][h+2]&&t[u+1][h+2]===t[u+2][h+1]&&t[u+2][h+1]===t[u+3][h]&&0!==t[u][h+3]&&(a.push([h,u+3]),a.push([h+1,u+2]),a.push([h+2,u+1]),a.push([h+3,u]),r=t[u][h+3]);1===r&&(this.gameover=!0,n=this.props.state.players[this.props.state.game.playerA].name+" has won the game!");2===r&&(n=this.props.state.players[this.props.state.game.playerB].name+" has won the game!",this.gameover=!0);if(0===a.length){if(t.flat().filter((function(e){return 1===e})).length<=t.flat().filter((function(e){return 2===e})).length)n=this.props.state.players[this.props.state.game.playerA].name+"'s turn";else n=this.props.state.players[this.props.state.game.playerB].name+"'s turn";void 0===t.flat().find((function(e){return 0===e}))&&(this.gameover=!0,n="Game finished with a tie!")}var m=[];return setTimeout((function(){e.updateBoardSizing()}),1),t.forEach((function(t,n){var i=[];t.forEach((function(t,r){var o=a.find((function(e){return e[0]===r&&e[1]===n}));i.push(Object(s.jsxs)("div",{onClick:function(){e.checkField(r)},className:"vierGewinntCell",children:[Object(s.jsx)("div",{className:"vierGewinntCellOverlay "+(o?" vierGewinntWinningCell ":"")}),Object(s.jsx)("div",{className:"vierGewinntCell"+t})]}))})),m=[].concat(Object(S.a)(m),i)})),this.gameover&&(i=Object(s.jsxs)("div",{className:"panel-block",children:[Object(s.jsx)("button",{className:"button is-fullwidth ",onClick:function(){return k().sendMessage({gameConfig:{running:!1},game:void 0})},children:"Back to lobby"}),Object(s.jsx)("button",{className:"button is-fullwidth is-primary",onClick:function(){return setTimeout((function(){(new I).start(e.props.state)}),1)},children:"Restart game"})]})),Object(s.jsxs)("div",{className:"container is-half-desktop",children:[this.state.redirect?Object(s.jsx)(f.a,{to:this.state.redirect}):"",Object(s.jsx)("div",{className:"column is-6 is-offset-3",children:Object(s.jsxs)("nav",{className:"panel",children:[Object(s.jsx)("p",{className:"panel-heading",children:"Vier Gewinnt"}),Object(s.jsx)("p",{ref:this.boardRef,className:"panel-block",children:n}),Object(s.jsx)("p",{ref:this.boardRef,className:"panel-block vierGewinntBoard",children:m}),i]})})]})}},{key:"updateBoardSizing",value:function(){var e,t;(null===(e=this.boardRef)||void 0===e||null===(t=e.current)||void 0===t?void 0:t.clientWidth)&&document.documentElement.style.setProperty("--cellWidth",this.boardRef.current.clientWidth/7+"px")}}]),a}(n.Component),P=(a(47),a(33)),B=a(24),E=a(25),G=(a(48),function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(d.a)(this,a),(e=t.call(this)).name="Tanks",e.minPlayers=2,e.maxPlayers=10,e}return Object(h.a)(a,[{key:"getComponent",value:function(e){return Object(n.createElement)(J,e)}},{key:"start",value:function(e){var t=y(Object.keys(e.players)),a={};t.forEach((function(e,s){a[e]={x:800/(t.length+1)*(s+1),y:50,vx:0,vy:0,dir:0}})),k().sendMessage({gameConfig:{running:!0},game:{field:{seed:Math.random()},players:a}})}}]),a}(M)),J=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var s;return Object(d.a)(this,a),(s=t.call(this,e)).state={},s.canvasRef=Object(n.createRef)(),s.tankImgRef=Object(n.createRef)(),s.moveNippleRef=Object(n.createRef)(),s.shootNippleRef=Object(n.createRef)(),s.recordingCountdownRef=Object(n.createRef)(),s.terrain=s.renderTerrain(e.state.game.field.seed),s.actor=void 0,s.game=s.props.state.game,s.recording=[],s.recordingFrames=150,s.status="idle",s.lastShootButtonPressed=!1,s.actor=JSON.parse(JSON.stringify(s.game.players[k().player.id])),s}return Object(h.a)(a,[{key:"simulateGame",value:function(){var e;if(this.shootButtonPressed&&this.shootCounter++,null===(e=this.canvasRef)||void 0===e?void 0:e.current){this.canvasRef.current.getContext("2d");for(var t in this.actor&&this.simulateTank(this.actor),this.game.players){var a=this.game.players[t];if(this.simulateTank(a),t===k().player.id&&"recording"===this.status){if(this.lastShootButtonPressed!==this.shootButtonPressed&&this.lastShootButtonPressed)this.recording.push({t:"s",d:a.dir,f:this.getShootForce()});else{var s=this.recording[this.recording.length-1];(null===s||void 0===s?void 0:s.vx)===a.vx?void 0!==(null===s||void 0===s?void 0:s.r)?s.r++:s.r=2:this.recording.push({vx:a.vx})}if(this.recording.map((function(e){return e.r?e.r:1})).reduce((function(e,t){return e+t}),0)>150){this.status="synchronizing",this.actor=void 0,console.log("recorded instructions"),console.log(this.recording);var n={};n[k().player.id]={recording:this.recording},k().sendMessage({game:{players:n}})}}}}this.lastShootButtonPressed=this.shootButtonPressed}},{key:"simulateTank",value:function(e){var t,a=4*Math.round(Math.round(e.x)-this.tankImgRef.current.width/2+Math.round(e.y)*this.terrain.width)+3;if(this.terrainData[a]<100&&this.terrainData[a+4*this.tankImgRef.current.width]<100)for(e.vy=Math.min(3,e.vy+.1),t=Math.round(e.vy);t>=0;t--)if(this.terrainData[a+4*t*this.terrain.width]<100&&this.terrainData[a+4*t*this.terrain.width+4*this.tankImgRef.current.width]<100){e.y+=t;break}if(Math.abs(e.vx)>0){var s,n=4*Math.round(Math.round(e.x)+Math.round(e.vx)-Math.round(this.tankImgRef.current.width/2)+Math.round(e.y)*this.terrain.width)+3;for(s=0;s<5;s++)if(Math.abs(e.vx)>0&&this.terrainData[n-4*s*this.terrain.width]<100&&this.terrainData[n-4*s*this.terrain.width+4*this.tankImgRef.current.width]<100){e.x+=e.vx,e.y-=s;break}}}},{key:"renderGame",value:function(){var e,t,a=this;if((null===(e=this.moveNippleRef)||void 0===e?void 0:e.current)&&!this.moveStick){var s={zone:this.moveNippleRef.current,mode:"static",color:"red",position:{top:"50%",left:"50%"}};this.moveStick=E.create(s),this.moveStick.on("move",(function(e,t){"idle"===a.status&&(a.status="recording"),"recording"===a.status&&(t.force>.75?a.actor.vx=2*Math.sign(t.vector.x):a.actor.vx=0)})),this.moveStick.on("end",(function(e,t){"recording"===a.status&&(a.actor.vx=0)})),s={zone:this.shootNippleRef.current,mode:"static",color:"red",position:{top:"50%",left:"50%"}},this.shootStick=E.create(s),this.shootStick.on("move",(function(e,t){"recording"===a.status&&(a.actor.dir=t.angle.degree)})),this.shootStick.on("start",(function(e,t){"idle"===a.status&&(a.status="recording"),"recording"===a.status&&(a.shootButtonPressed=!0,a.shootCounter=0)})),this.shootStick.on("end",(function(e,t){a.shootButtonPressed=!1}))}if(null===(t=this.canvasRef)||void 0===t?void 0:t.current){var n=this.canvasRef.current;n.width=this.terrain.width,n.height=this.terrain.height;var i,r=n.getContext("2d");if(r.drawImage(this.terrain,0,0),"idle"===this.status)(null===(i=this.recordingCountdownRef)||void 0===i?void 0:i.current)&&(this.recordingCountdownRef.current.innerHTML="Start input to record next move");else if("recording"===this.status){var o,c=this.recording.map((function(e){return e.r?e.r:1})).reduce((function(e,t){return e+t}),0);(null===(o=this.recordingCountdownRef)||void 0===o?void 0:o.current)&&(this.recordingCountdownRef.current.innerHTML=Math.ceil((150-c)/30))}else if("synchronizing"===this.status){var l;(null===(l=this.recordingCountdownRef)||void 0===l?void 0:l.current)&&(this.recordingCountdownRef.current.innerHTML="Waiting for other inputs ...")}for(var d in this.game.players){var h=this.game.players[d];this.drawTank(n,r,h,!1,this.props.state.players[d].color)}this.actor&&this.drawTank(n,r,this.actor,!0,k().player.color)}}},{key:"drawTank",value:function(e,t,a,s,n){var i=new OffscreenCanvas(this.tankImgRef.current.width,this.tankImgRef.current.height),r=i.getContext("2d");if(t.globalAlpha=s?1:.2,s&&this.shootButtonPressed){var o=this.getShootForce();t.beginPath(),t.moveTo(a.x,a.y-10),t.lineTo(a.x+100*Math.cos((a.dir+10)*Math.PI/180)*o,a.y-10-100*Math.sin((a.dir+10)*Math.PI/180)*o),t.lineTo(a.x+100*Math.cos((a.dir-10)*Math.PI/180)*o,a.y-10-100*Math.sin((a.dir-10)*Math.PI/180)*o),t.lineTo(a.x,a.y-10),t.closePath(),t.fillStyle="gray",t.lineWidth=1,t.fill()}t.beginPath(),t.moveTo(a.x,a.y-10),t.lineTo(a.x+20*Math.cos(a.dir*Math.PI/180),a.y-10-20*Math.sin(a.dir*Math.PI/180)),t.closePath(),t.strokeStyle=n,t.lineWidth=4,t.stroke(),r.fillStyle=n,r.fillRect(0,0,i.width,i.height),r.globalCompositeOperation="multiply",r.drawImage(this.tankImgRef.current,0,0),r.globalCompositeOperation="destination-in",r.drawImage(this.tankImgRef.current,0,0),t.globalCompositeOperation="source-over",t.drawImage(i,a.x-this.tankImgRef.current.width/2,a.y-this.tankImgRef.current.height),t.globalAlpha=1}},{key:"renderTerrain",value:function(e){var t=new P.Noise(e),a=new OffscreenCanvas(800,400),s=a.getContext("2d");s.fillStyle="#ffffff00",s.fillRect(0,0,a.width,a.height),s.beginPath(),s.moveTo(0,a.height);for(var n=0;n<a.width;n++)s.lineTo(n,a.height-200-100*t.simplex2(n/200,0));s.lineTo(a.width,a.height),s.closePath(),s.fillStyle="#000000ff",s.fill();var i=s.getImageData(0,0,a.width,a.height);return this.terrainData=i.data,a}},{key:"render",value:function(){var e=this;this.props.state.game.field;this.gameover=!1,this.updateLoop&&clearInterval(this.updateLoop);return this.updateLoop=setInterval((function(){e.renderGame(),e.simulateGame()}),30),Object(s.jsxs)("div",{className:"container is-half-desktop",children:[this.state.redirect?Object(s.jsx)(f.a,{to:this.state.redirect}):"",Object(s.jsx)("div",{className:"column is-12",children:Object(s.jsxs)("nav",{className:"panel",children:[Object(s.jsx)("p",{className:"panel-heading",children:"Tanks"}),Object(s.jsxs)("div",{className:"panel-block",children:[Object(s.jsx)(B.b,{options:{limitToBounds:!0,limitToWrapper:!1},children:Object(s.jsx)(B.a,{children:Object(s.jsx)("canvas",{className:"tanksCanvas",ref:this.canvasRef})})}),Object(s.jsx)("img",{ref:this.tankImgRef,style:{display:"none"},src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAANCAYAAACzbK7QAAABhWlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw1AUhU9TpSIVh3YQcchQdbEgKtJRqlgEC6Wt0KqDyUv/oElDkuLiKLgWHPxZrDq4OOvq4CoIgj8gbm5Oii5S4n1JoUWMFx7v47x7Du/dBwjNKlPNnklA1SwjnYiLufyqGHiFDwJCGEdMYqaezCxm4Vlf99RNdRflWd59f9aAUjAZ4BOJ55huWMQbxLObls55nzjMypJCfE48YdAFiR+5Lrv8xrnksMAzw0Y2PU8cJhZLXSx3MSsbKvEMcURRNcoXci4rnLc4q9U6a9+TvzBY0FYyXKc1ggSWkEQKImTUUUEVFqK0a6SYSNN53MM/7PhT5JLJVQEjxwJqUCE5fvA/+D1bszg95SYF40Dvi21/jAKBXaDVsO3vY9tunQD+Z+BK6/hrTSD2SXqjo0WOgMFt4OK6o8l7wOUOMPSkS4bkSH5aQrEIvJ/RN+WB0C3Qv+bOrX2O0wcgS7NavgEODoGxEmWve7y7r3tu//a05/cDsIZywPvHnmUAAAAGYktHRAD/AP8A/6C9p5MAAAAJcEhZcwAALiMAAC4jAXilP3YAAAAHdElNRQflAQITNBXVo8ufAAAAGXRFWHRDb21tZW50AENyZWF0ZWQgd2l0aCBHSU1QV4EOFwAAAhlJREFUOMt9Ur2rGkEQn9vZPYNRMeDzo07zckSbkBP7EFKmy9+QNn9AqkCK5DW+VkEUTBWwz/8QSKOvOATLK4yg4sd+TRr3WN/zZWC42eH29zE7APdiPB5/WiwWf1arld5ut/ZwOJBSiqSUZ3k8Hmm/39Nms7HL5XI5nU5/dLvdj/C/6Pf735IkWaVpSuv1mg6HA0kpyRjzIJVSdDweabfb0Xq9pjRNKUmSv4PB4LuPyfxDq9V6J4QoIyIwxiAIgrPvYwkAwBgDIcSzZrP5/iIBERUKhcK1Dw4AEARBVvvh+j45IkKxWHx+kaDX633lnCMinl0+kYO19kE6IgeOiMA5p9FodOtw0amXUn4plUq1MAxBCJGpIqJH01qb1cYY1wsqlcqrOI6vJ5PJTw4AMBwOb+M4jtxo3GVjTObCKb4/Jt+NewvOOUZR9BYAAG9ubnrtdvtDPp/PCSEyq74qrTUYYy6m+88YAwCQ1YyxfL1eD3kURS+FEE+dAmstKKUyJ67nAHz1vmPnBgDALUqn0+nwcrl8xTnP2J1i/3GNMRdH5G+cP0oiAkSEarX6mgPAxoH5wL51fwR+cM4zEp/ICWOMMZ6m6e9SqfRCax06YK312dxdfYmAc56tqdu+ExHtdrs73mg0Ps/nc6zVam8YY1fWWlRKMSklaa3JJzoJIGutIiKFiJTL5VAI8SQMQxRC0ImElFLz2Wz26x/0dLsgoOCydAAAAABJRU5ErkJggg=="}),Object(s.jsx)("div",{ref:this.recordingCountdownRef,style:{position:"fixed",width:"20vmin",marginLeft:"-10vmin",textAlign:"center",left:"50%",top:0}})]}),Object(s.jsx)("div",{className:"card",style:{position:"fixed",margin:"5vmin",bottom:0,width:"30vmin",height:"30vmin",left:0},ref:this.moveNippleRef,children:"Move"}),Object(s.jsx)("div",{className:"card",style:{position:"fixed",margin:"5vmin",bottom:0,width:"30vmin",height:"30vmin",right:0,textAlign:"right"},ref:this.shootNippleRef,children:"Shoot"}),""]})})]})}},{key:"updateBoardSizing",value:function(){var e,t;(null===(e=this.boardRef)||void 0===e||null===(t=e.current)||void 0===t?void 0:t.clientWidth)&&document.documentElement.style.setProperty("--cellWidth",this.boardRef.current.clientWidth/7+"px")}},{key:"getShootForce",value:function(){return Math.abs(Math.sin(this.shootCounter/30))}}]),a}(n.Component),W=(a(28),function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(d.a)(this,a),(e=t.call(this)).name="Memory",e.minPlayers=2,e.maxPlayers=4,e}return Object(h.a)(a,[{key:"getComponent",value:function(e){return Object(n.createElement)(F,e)}},{key:"start",value:function(e){for(var t=y(Object.keys(e.players)),a=[],s=1;s<=232;s++)a.push(s);a=(a=y(a)).slice(0,Math.floor(20)),a=y(a=[].concat(Object(S.a)(a),Object(S.a)(a))),k().sendMessage({gameConfig:{running:!0},game:{solution:a,solved:a.map((function(e){return-1})),turn:0,playerOrder:t}})}}]),a}(M)),F=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var s;return Object(d.a)(this,a),(s=t.call(this,e)).state={},s.boardRef=Object(n.createRef)(),s.checkField=s.checkField.bind(Object(c.a)(s)),window.onresize=function(){s.updateBoardSizing()},s}return Object(h.a)(a,[{key:"isMyTurn",value:function(){var e=this.props.state.game.turn%this.props.state.game.playerOrder.length;return this.props.state.game.playerOrder.indexOf(k().player.id)===e}},{key:"checkField",value:function(e){var t=this,a=JSON.parse(JSON.stringify(this.props.state.game.solved)),s=this.props.state.game.solution,n=this.props.state.game.playerOrder.indexOf(k().player.id),i=1e3+n;this.isMyTurn()&&2!==a.filter((function(e){return e===i})).length&&(a[e]=i,k().sendMessage({game:{solved:a}}),this.isMyTurn()&&2===a.filter((function(e){return e===i})).length&&setTimeout((function(){var e=a.map((function(e,t){return[e,s[t],t]})).filter((function(e){return e[0]===i}));e[0][1]===e[1][1]?(a[e[0][2]]=n,a[e[1][2]]=n,k().sendMessage({game:{solved:a}})):(a[e[0][2]]=-1,a[e[1][2]]=-1,k().sendMessage({game:{solved:a,turn:t.props.state.game.turn+1}}))}),1e3))}},{key:"render",value:function(){var e,t,a,n,i,r,o,c,l,d,h=this,u=this.props.state.game.solution,m=this.props.state.game.solved,p="";this.gameover=!1;for(var j=void 0===m.find((function(e){return-1===e})),g=[],b=function(e){var t="white";-1!==m[e]&&m[e]<1e3&&(t=h.props.state.players[h.props.state.game.playerOrder[m[e]]].color),g.push(Object(s.jsx)("div",{className:"memoryCell",onClick:function(){return h.checkField(e)},children:Object(s.jsxs)("div",{className:"memoryCardInner"+(-1!==m[e]?" flipped":""),children:[Object(s.jsx)("div",{className:"memoryCardBack"}),Object(s.jsxs)("div",{style:{backgroundColor:t},className:"memoryCard",children:[Object(s.jsx)("img",{src:"imgs/memory/"+u[e]+".svg"})," "]})]})}))},v=0;v<u.length;v++)b(v);setTimeout((function(){h.updateBoardSizing()}),1);var O=(null===(e=this.props)||void 0===e||null===(t=e.state)||void 0===t||null===(a=t.game)||void 0===a?void 0:a.turn)%this.props.state.game.playerOrder.length;null===(n=this.props)||void 0===n||null===(i=n.state)||void 0===i||null===(r=i.players[null===(o=this.props)||void 0===o||null===(c=o.state)||void 0===c||null===(l=c.game)||void 0===l?void 0:l.playerOrder[O]])||void 0===r||r.name;for(var y={},x=0;x<this.props.state.game.playerOrder.length;x++)y[x]=0;y=m.filter((function(e){return e>=0&&e<1e3})).reduce((function(e,t){return void 0===e[t]?e[t]=1:e[t]++,y}),y);var C=[];for(var N in y){var w=this.props.state.players[this.props.state.game.playerOrder[N]];C.push(Object(s.jsxs)("div",{className:"playerStatus "+(N===O+""?" currentPlayer ":""),style:{borderColor:w.color},children:[w.name,Object(s.jsx)("br",{}),y[N]/2]}))}return d=Object(s.jsx)("div",{style:{display:"flex"},className:"playerStatusBar",children:C}),j&&(p=Object(s.jsxs)("div",{className:"panel-block",children:[Object(s.jsx)("button",{className:"button is-fullwidth ",onClick:function(){return k().sendMessage({gameConfig:{running:!1},game:void 0})},children:"Back to lobby"}),Object(s.jsx)("button",{className:"button is-fullwidth is-primary",onClick:function(){return setTimeout((function(){(new W).start(h.props.state)}),1)},children:"Restart game"})]})),Object(s.jsxs)("div",{className:"container is-half-desktop",children:[this.state.redirect?Object(s.jsx)(f.a,{to:this.state.redirect}):"",Object(s.jsx)("div",{className:"column is-6 is-offset-3",children:Object(s.jsxs)("nav",{className:"panel",children:[Object(s.jsx)("p",{className:"panel-heading",children:"Memory"}),Object(s.jsx)("p",{ref:this.boardRef,className:"panel-block",children:d}),Object(s.jsx)("p",{ref:this.boardRef,className:"panel-block memoryBoard",children:g}),p]})})]})}},{key:"updateBoardSizing",value:function(){var e,t;(null===(e=this.boardRef)||void 0===e||null===(t=e.current)||void 0===t?void 0:t.clientWidth)&&document.documentElement.style.setProperty("--cellWidth",this.boardRef.current.clientWidth/5+"px")}}]),a}(n.Component),z=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(d.a)(this,a),(e=t.call(this)).name="Tournament",e.minPlayers=2,e.maxPlayers=100,e}return Object(h.a)(a,[{key:"getComponent",value:function(e){return Object(n.createElement)(U,e)}},{key:"start",value:function(e){y(Object.keys(e.players));for(var t=[],a=1;a<=232;a++)t.push(a);t=(t=y(t)).slice(0,Math.floor(20)),t=y(t=[].concat(Object(S.a)(t),Object(S.a)(t))),k().sendMessage({gameConfig:{running:!0},game:{}})}}]),a}(M),U=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var s;return Object(d.a)(this,a),(s=t.call(this,e)).state={},s.boardRef=Object(n.createRef)(),s.checkField=s.checkField.bind(Object(c.a)(s)),window.onresize=function(){s.updateBoardSizing()},s}return Object(h.a)(a,[{key:"render",value:function(){var e,t,a,n,i,r,o,c,l,d,h=this,u=this.props.state.game.solution,m=this.props.state.game.solved,p="";this.gameover=!1;for(var j=[],g=function(e){var t="white";-1!==m[e]&&m[e]<1e3&&(t=h.props.state.players[h.props.state.game.playerOrder[m[e]]].color),j.push(Object(s.jsx)("div",{className:"memoryCell",onClick:function(){return h.checkField(e)},children:Object(s.jsxs)("div",{className:"memoryCardInner"+(-1!==m[e]?" flipped":""),children:[Object(s.jsx)("div",{className:"memoryCardBack"}),Object(s.jsxs)("div",{style:{backgroundColor:t},className:"memoryCard",children:[Object(s.jsx)("img",{src:"imgs/memory/"+u[e]+".svg"})," "]})]})}))},b=0;b<u.length;b++)g(b);setTimeout((function(){h.updateBoardSizing()}),1);var v=(null===(e=this.props)||void 0===e||null===(t=e.state)||void 0===t||null===(a=t.game)||void 0===a?void 0:a.turn)%this.props.state.game.playerOrder.length;return d=(null===(n=this.props)||void 0===n||null===(i=n.state)||void 0===i||null===(r=i.players[null===(o=this.props)||void 0===o||null===(c=o.state)||void 0===c||null===(l=c.game)||void 0===l?void 0:l.playerOrder[v]])||void 0===r?void 0:r.name)+"'s turn",this.gameover&&(p=Object(s.jsxs)("div",{className:"panel-block",children:[Object(s.jsx)("button",{className:"button is-fullwidth ",onClick:function(){return k().sendMessage({gameConfig:{running:!1},game:void 0})},children:"Back to lobby"}),Object(s.jsx)("button",{className:"button is-fullwidth is-primary",onClick:function(){return setTimeout((function(){(new z).start(h.props.state)}),1)},children:"Restart game"})]})),Object(s.jsxs)("div",{className:"container is-half-desktop",children:[this.state.redirect?Object(s.jsx)(f.a,{to:this.state.redirect}):"",Object(s.jsx)("div",{className:"column is-6 is-offset-3",children:Object(s.jsxs)("nav",{className:"panel",children:[Object(s.jsx)("p",{className:"panel-heading",children:"Memory"}),Object(s.jsx)("p",{ref:this.boardRef,className:"panel-block",children:d}),Object(s.jsx)("p",{ref:this.boardRef,className:"panel-block memoryBoard",children:j}),p]})})]})}},{key:"updateBoardSizing",value:function(){var e,t;(null===(e=this.boardRef)||void 0===e||null===(t=e.current)||void 0===t?void 0:t.clientWidth)&&document.documentElement.style.setProperty("--cellWidth",this.boardRef.current.clientWidth/5+"px")}}]),a}(n.Component),D=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var s;return Object(d.a)(this,a),(s=t.call(this,e)).state={},s}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=this;k().addCallback((function(t){e.setState(JSON.parse(JSON.stringify(t)))}))}},{key:"render",value:function(){var e=this,t=this.state.redirect?Object(s.jsx)(f.a,{to:this.state.redirect,push:!0}):"";return Object(s.jsxs)(p.a,{children:[t,Object(s.jsx)("div",{children:Object(s.jsxs)(f.d,{children:[Object(s.jsx)(f.b,{path:"/author",render:function(e){return Object(s.jsx)(K,Object(l.a)({},e))}}),Object(s.jsx)(f.b,{path:"/:id/:subid",render:function(t){return Object(s.jsx)(L,Object(l.a)({state:e.state},t))}}),Object(s.jsx)(f.b,{path:"/:id",render:function(t){return Object(s.jsx)(L,Object(l.a)({state:e.state},t))}}),Object(s.jsx)(f.b,{path:"/",render:function(e){return Object(s.jsx)(Q,Object(l.a)({},e))}})]})})]})}}]),a}(n.Component),L=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var s;return Object(d.a)(this,a),(s=t.call(this,e)).games=[new W,new G,new I,new A],k().initialize(s.props.match.params.id,s.games[0]),s.state={username:k().player.name,color:k().player.color,gameSelectionModal:!1},s.usernameChanged=s.usernameChanged.bind(Object(c.a)(s)),s.colorChanged=s.colorChanged.bind(Object(c.a)(s)),s.startGame=s.startGame.bind(Object(c.a)(s)),s}return Object(h.a)(a,[{key:"usernameChanged",value:function(e){this.setState({username:e.target.value}),this.nameChangedTimeout&&(clearTimeout(this.nameChangedTimeout),this.nameChangedTimeout=void 0),this.nameChangedTimeout=setTimeout((function(){k().setPlayerName(e.target.value)}),1e3)}},{key:"colorChanged",value:function(e){this.setState({color:e.target.value}),this.colorChangedTimeout&&(clearTimeout(this.colorChangedTimeout),this.colorChangedTimeout=void 0),this.colorChangedTimeout=setTimeout((function(){k().setPlayerColor(e.target.value)}),1e3)}},{key:"startGame",value:function(){var e=this;this.games.find((function(t){return t.name===e.props.state.gameConfig.name})).start(this.props.state)}},{key:"selectGame",value:function(e){k().sendMessage({gameConfig:{name:e.name}})}},{key:"render",value:function(){var e,t,a,n,i=this,r=this.props.match.params.id;if(this.props.state.gameConfig&&this.props.state.gameConfig.running)return this.games.find((function(e){return e.name===i.props.state.gameConfig.name})).getComponent(this.props);this.props.state.players&&(n=Object.keys(this.props.state.players).map((function(e){var t=i.props.state.players[e];return t.id===k().player.id?Object(s.jsxs)("a",{className:"panel-block is-active",children:[Object(s.jsx)("span",{className:"panel-icon",children:Object(s.jsx)("i",{className:"fas fa-user"})}),Object(s.jsx)("input",{style:{borderRadius:"100%",width:"3em"},type:"color",className:"input",value:i.state.color,onChange:i.colorChanged}),Object(s.jsx)("input",{placeholder:"username",type:"text",className:"input",value:i.state.username,onChange:i.usernameChanged}),Object(s.jsx)("br",{})]},"player"+t.id):Object(s.jsxs)("a",{className:"panel-block",children:[Object(s.jsx)("span",{className:"panel-icon",children:Object(s.jsx)("i",{className:"fas fa-user","aria-hidden":"true"})}),Object(s.jsx)("span",{style:{width:"1em",height:"1em",borderRadius:"100%",margin:"1em",backgroundColor:t.color}}),t.name]},"player"+t.id)})));var o=this.games.map((function(e){return Object(s.jsxs)("tr",{onClick:function(){i.selectGame(e),i.setState({gameSelectionModal:!1})},style:{cursor:"pointer"},children:[Object(s.jsx)("td",{children:e.name}),Object(s.jsxs)("td",{children:[e.minPlayers," - ",e.maxPlayers]}),Object(s.jsxs)("td",{children:[Object(s.jsx)("button",{className:"button is-primary",children:">"})," "]})]})}));return Object(s.jsxs)("div",{children:[Object(s.jsxs)("div",{className:"container is-half-desktop",children:[this.state.redirect?Object(s.jsx)(f.a,{to:this.state.redirect}):"",Object(s.jsxs)("div",{className:"column is-6 is-offset-3",children:[Object(s.jsxs)("nav",{className:"panel",children:[Object(s.jsx)("p",{className:"panel-heading",children:"Game Lobby"}),Object(s.jsx)("p",{className:"panel-block",children:r}),Object(s.jsxs)("p",{className:"panel-block",children:[null===(e=this.props)||void 0===e||null===(t=e.state)||void 0===t||null===(a=t.gameConfig)||void 0===a?void 0:a.name,Object(s.jsx)("button",{className:"button is-small",style:{marginLeft:"1em"},onClick:function(){return i.setState({gameSelectionModal:!0})},children:" change game"})]}),Object(s.jsxs)("p",{className:"panel-tabs",children:[Object(s.jsx)("a",{className:"is-active",children:"Players"}),Object(s.jsx)("a",{className:"is-disabled",children:"Settings"})]}),n]}),Object(s.jsx)("button",{onClick:this.startGame,disabled:!1,className:"button is-large is-primary is-fullwidth",children:"Start Game"})]})]}),Object(s.jsxs)("div",{className:"modal "+(this.state.gameSelectionModal?"is-active":""),children:[Object(s.jsx)("div",{className:"modal-background",onClick:function(){return i.setState({gameSelectionModal:!1})}}),Object(s.jsxs)("div",{className:"modal-card",children:[Object(s.jsxs)("header",{className:"modal-card-head",children:[Object(s.jsx)("p",{className:"modal-card-title",children:"Modal title"}),Object(s.jsx)("button",{className:"delete","aria-label":"close",onClick:function(){return i.setState({gameSelectionModal:!1})}})]}),Object(s.jsx)("section",{className:"modal-card-body",children:Object(s.jsxs)("table",{className:"table is-fullwidth  is-hoverable",children:[Object(s.jsx)("thead",{children:Object(s.jsxs)("tr",{children:[Object(s.jsx)("th",{children:"Game"}),Object(s.jsx)("th",{children:"# Players"}),Object(s.jsx)("th",{})]})}),Object(s.jsx)("tbody",{children:o})]})})]})]})]})}}]),a}(n.Component),Q=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var s;return Object(d.a)(this,a),(s=t.call(this,e)).state={joinId:""},s.hostGame=s.hostGame.bind(Object(c.a)(s)),s.joinGame=s.joinGame.bind(Object(c.a)(s)),s.joinGameIdChanged=s.joinGameIdChanged.bind(Object(c.a)(s)),s}return Object(h.a)(a,[{key:"hostGame",value:function(){var e=function(e){for(var t="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",s=a.length,n=0;n<e;n++)t+=a.charAt(Math.floor(Math.random()*s));return t}(8);this.setState({redirect:e})}},{key:"joinGame",value:function(){this.setState({redirect:this.state.joinId})}},{key:"joinGameIdChanged",value:function(e){this.setState({joinId:e.target.value})}},{key:"render",value:function(){this.props.match.params.id;return Object(s.jsxs)("div",{className:"container is-half-desktop",children:[this.state.redirect?Object(s.jsx)(f.a,{to:this.state.redirect}):"",Object(s.jsxs)("div",{className:"column is-6 is-offset-3",children:[Object(s.jsx)("button",{onClick:this.hostGame,className:"button is-large is-primary is-fullwidth",children:"Host Game"}),Object(s.jsx)("br",{}),Object(s.jsx)("br",{}),Object(s.jsx)("input",{placeholder:"enter 8 digit session code",type:"text",className:"input",value:this.state.joinId,onChange:this.joinGameIdChanged}),Object(s.jsx)("br",{}),Object(s.jsx)("button",{onClick:this.joinGame,disabled:this.state.joinId.length<8,className:"button is-large  is-fullwidth",children:"Join Game"})]})]})}}]),a}(n.Component),K=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var s;return Object(d.a)(this,a),(s=t.call(this,e)).state={},s.emojiInput=Object(n.createRef)(),s.onEmojiClick=s.onEmojiClick.bind(Object(c.a)(s)),s}return Object(h.a)(a,[{key:"onEmojiClick",value:function(e,t){var a=this.emojiInput.current.selectionStart,s=this.emojiInput.current.selectionEnd;this.emojiInput.current.value=this.emojiInput.current.value.substring(0,a)+t.emoji+this.emojiInput.current.value.substring(s,this.emojiInput.current.value.length),this.emojiInput.current.focus(),this.emojiInput.current.selectionStart=a+t.emoji.length,this.emojiInput.current.selectionEnd=a+t.emoji.length}},{key:"render",value:function(){this.props.match.params.id;return Object(s.jsxs)("div",{className:"container is-half-desktop",children:[this.state.redirect?Object(s.jsx)(f.a,{to:this.state.redirect}):"",Object(s.jsx)("div",{className:"column is-6 is-offset-3",children:Object(s.jsxs)("article",{className:"panel is-primary",children:[Object(s.jsx)("p",{className:"panel-heading",children:"Fernbedienung"}),Object(s.jsxs)("div",{className:"panel-block",children:[Object(s.jsx)("div",{className:"notification is-primary is-light",style:{padding:"0.5rem 1rem 0.5rem 0.75rem"},children:"Flieger"}),Object(s.jsx)("br",{}),Object(s.jsx)("br",{}),Object(s.jsx)("br",{})]}),Object(s.jsxs)("div",{className:"panel-block",children:[Object(s.jsx)("input",{style:{fontSize:"x-large"},className:"input",type:"text",ref:this.emojiInput}),Object(s.jsx)("button",{style:{fontSize:"x-large",marginLeft:".5em",paddingLeft:"calc(.75em - 1px)",paddingRight:"calc(.75em - 1px)"},className:"button is-primary is-rounded",children:Object(s.jsx)("i",{className:"fas fa-paper-plane"})})]}),Object(s.jsx)("div",{className:"panel-block",style:{padding:0},children:Object(s.jsx)(w.a,{onEmojiClick:this.onEmojiClick,disableSearchBar:!0,style:{width:"100%"}})})]})})]})}}]),a}(n.Component),Y=D,q=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,50)).then((function(t){var a=t.getCLS,s=t.getFID,n=t.getFCP,i=t.getLCP,r=t.getTTFB;a(e),s(e),n(e),i(e),r(e)}))};o.a.render(Object(s.jsx)(i.a.StrictMode,{children:Object(s.jsx)(Y,{})}),document.getElementById("root")),q()}},[[49,1,2]]]);
//# sourceMappingURL=main.f1890713.chunk.js.map